from os.path import dirname, join

import yaml


class Config(object):
    SECRET_KEY = 'super top secret key'

    REGISTRY_API_BASE_URL = 'https://iatiregistry.org/api/3/action'
    CELERY_BROKER_URL = 'redis://localhost:6379/0'
    CELERY_RESULT_BACKEND = 'redis://localhost:6379/0'
    CACHE_TIMEOUT = 86400  # 24 hours
    CURRENT_PATH = dirname(__file__)
    MEDIA_FOLDER = join(CURRENT_PATH, 'media')
    SQLALCHEMY_DATABASE_URI = 'sqlite:///{}'.format(
        join(CURRENT_PATH, 'db.sqlite3'))
    SQLALCHEMY_TRACK_MODIFICATIONS = False
    ALLOWED_EXTENSIONS = ('xml',)
    TEST_SETS = {
        'pwyf': {
            'name': 'Aid Transparency Index tests',
            'description': 'These tests only run on current data. They ' +
                           'comprise the automated component of the Aid ' +
                           'Transparency Index, which aims to rank donors ' +
                           'by data quality.',
            'filename': join(CURRENT_PATH, 'test_definitions',
                             'pwyf-tests.yaml'),
            'filepath': join(CURRENT_PATH, 'test_definitions', 'index_2017'),
        },
    }
    DEFAULT_TEST_SET = 'pwyf'
    PER_PAGE = 10

    with open(join(CURRENT_PATH, 'codelists.yaml')) as f:
        CODELISTS = yaml.load(f)
